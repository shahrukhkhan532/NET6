name: CI/CD
on:
  push:
    branches:
      - ftp_2
jobs:
  Deploy_Through_FTP:
    runs-on: windows-latest
    steps:
      - name: Check Out Code ðŸš“
        uses: actions/checkout@v3
      
      - name: Is variable exported? âš™
        shell: PowerShell
        run: |
          $uu = "Shah Rukh Khan"
          echo "BUILD_VERSION=$uu" | Out-File -FilePath $Env:GITHUB_ENV -Encoding utf8 -Append
      
      - name: Read exported variable
        shell: PowerShell
        run: |
          echo "${{ env.BUILD_VERSION}}"
          Write-Output "${{ env.BUILD_VERSION}}"
          switch ("${{ github.ref_name }}") {
              "ftp_2" {
                  Write-Output "QA Branch ..."
              }
              "staging" {
                  $appPoolName = "CareTrackerAPI"
                  $destinationPath = "C:\Working Directory\CareTrackerAPI"
                  $sourcePath = (".\" + $branch + "_" + "CTout\*")
                  Write-Output ("Staging Branch Deployment. App Pool: " + $appPoolName + ", Source: " + $sourcePath + ", Destination: " + $destinationPath)
              }
              Default {
                  Write-Output "The branch is unknown."
                  exit 1
              }
          }
